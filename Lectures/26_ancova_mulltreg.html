<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="generator" content="pandoc">
  <title>26_ancova_mulltreg.utf8</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="libs/reveal.js-3.3.0.1/css/reveal.css"/>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="libs/reveal.js-3.3.0.1/css/theme/white.css" id="theme">


  <!-- some tweaks to reveal css -->
  <style type="text/css">
    .reveal h1 { font-size: 2.0em; }
    .reveal h2 { font-size: 1.5em;  }
    .reveal h3 { font-size: 1.25em;	}
    .reveal h4 { font-size: 1em;	}

    .reveal .slides>section,
    .reveal .slides>section>section {
      padding: 0px 0px;
    }



    .reveal table {
      border-width: 1px;
      border-spacing: 2px;
      border-style: dotted;
      border-color: gray;
      border-collapse: collapse;
      font-size: 0.7em;
    }

    .reveal table th {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      font-weight: bold;
      border-style: dotted;
      border-color: gray;
    }

    .reveal table td {
      border-width: 1px;
      padding-left: 10px;
      padding-right: 25px;
      border-style: dotted;
      border-color: gray;
    }


  </style>

    <style type="text/css">code{white-space: pre;}</style>

    <link rel="stylesheet" href="style.css"/>

<!-- Printing and PDF exports -->
<script id="paper-css" type="application/dynamic-css">

/* Default Print Stylesheet Template
   by Rob Glazebrook of CSSnewbie.com
   Last Updated: June 4, 2008

   Feel free (nay, compelled) to edit, append, and
   manipulate this file as you see fit. */


@media print {

	/* SECTION 1: Set default width, margin, float, and
	   background. This prevents elements from extending
	   beyond the edge of the printed page, and prevents
	   unnecessary background images from printing */
	html {
		background: #fff;
		width: auto;
		height: auto;
		overflow: visible;
	}
	body {
		background: #fff;
		font-size: 20pt;
		width: auto;
		height: auto;
		border: 0;
		margin: 0 5%;
		padding: 0;
		overflow: visible;
		float: none !important;
	}

	/* SECTION 2: Remove any elements not needed in print.
	   This would include navigation, ads, sidebars, etc. */
	.nestedarrow,
	.controls,
	.fork-reveal,
	.share-reveal,
	.state-background,
	.reveal .progress,
	.reveal .backgrounds {
		display: none !important;
	}

	/* SECTION 3: Set body font face, size, and color.
	   Consider using a serif font for readability. */
	body, p, td, li, div {
		font-size: 20pt!important;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		color: #000;
	}

	/* SECTION 4: Set heading font face, sizes, and color.
	   Differentiate your headings from your body text.
	   Perhaps use a large sans-serif for distinction. */
	h1,h2,h3,h4,h5,h6 {
		color: #000!important;
		height: auto;
		line-height: normal;
		font-family: Georgia, "Times New Roman", Times, serif !important;
		text-shadow: 0 0 0 #000 !important;
		text-align: left;
		letter-spacing: normal;
	}
	/* Need to reduce the size of the fonts for printing */
	h1 { font-size: 28pt !important;  }
	h2 { font-size: 24pt !important; }
	h3 { font-size: 22pt !important; }
	h4 { font-size: 22pt !important; font-variant: small-caps; }
	h5 { font-size: 21pt !important; }
	h6 { font-size: 20pt !important; font-style: italic; }

	/* SECTION 5: Make hyperlinks more usable.
	   Ensure links are underlined, and consider appending
	   the URL to the end of the link for usability. */
	a:link,
	a:visited {
		color: #000 !important;
		font-weight: bold;
		text-decoration: underline;
	}
	/*
	.reveal a:link:after,
	.reveal a:visited:after {
		content: " (" attr(href) ") ";
		color: #222 !important;
		font-size: 90%;
	}
	*/


	/* SECTION 6: more reveal.js specific additions by @skypanther */
	ul, ol, div, p {
		visibility: visible;
		position: static;
		width: auto;
		height: auto;
		display: block;
		overflow: visible;
		margin: 0;
		text-align: left !important;
	}
	.reveal pre,
	.reveal table {
		margin-left: 0;
		margin-right: 0;
	}
	.reveal pre code {
		padding: 20px;
		border: 1px solid #ddd;
	}
	.reveal blockquote {
		margin: 20px 0;
	}
	.reveal .slides {
		position: static !important;
		width: auto !important;
		height: auto !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 0 !important;
		zoom: 1 !important;

		overflow: visible !important;
		display: block !important;

		text-align: left !important;
		-webkit-perspective: none;
		   -moz-perspective: none;
		    -ms-perspective: none;
		        perspective: none;

		-webkit-perspective-origin: 50% 50%;
		   -moz-perspective-origin: 50% 50%;
		    -ms-perspective-origin: 50% 50%;
		        perspective-origin: 50% 50%;
	}
	.reveal .slides section {
		visibility: visible !important;
		position: static !important;
		width: auto !important;
		height: auto !important;
		display: block !important;
		overflow: visible !important;

		left: 0 !important;
		top: 0 !important;
		margin-left: 0 !important;
		margin-top: 0 !important;
		padding: 60px 20px !important;
		z-index: auto !important;

		opacity: 1 !important;

		page-break-after: always !important;

		-webkit-transform-style: flat !important;
		   -moz-transform-style: flat !important;
		    -ms-transform-style: flat !important;
		        transform-style: flat !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;

		-webkit-transition: none !important;
		   -moz-transition: none !important;
		    -ms-transition: none !important;
		        transition: none !important;
	}
	.reveal .slides section.stack {
		padding: 0 !important;
	}
	.reveal section:last-of-type {
		page-break-after: avoid !important;
	}
	.reveal section .fragment {
		opacity: 1 !important;
		visibility: visible !important;

		-webkit-transform: none !important;
		   -moz-transform: none !important;
		    -ms-transform: none !important;
		        transform: none !important;
	}
	.reveal section img {
		display: block;
		margin: 15px 0px;
		background: rgba(255,255,255,1);
		border: 1px solid #666;
		box-shadow: none;
	}

	.reveal section small {
		font-size: 0.8em;
	}

}  
</script>


<script id="pdf-css" type="application/dynamic-css">
    
/**
 * This stylesheet is used to print reveal.js
 * presentations to PDF.
 *
 * https://github.com/hakimel/reveal.js#pdf-export
 */

* {
	-webkit-print-color-adjust: exact;
}

body {
	margin: 0 auto !important;
	border: 0;
	padding: 0;
	float: none !important;
	overflow: visible;
}

html {
	width: 100%;
	height: 100%;
	overflow: visible;
}

/* Remove any elements not needed in print. */
.nestedarrow,
.reveal .controls,
.reveal .progress,
.reveal .playback,
.reveal.overview,
.fork-reveal,
.share-reveal,
.state-background {
	display: none !important;
}

h1, h2, h3, h4, h5, h6 {
	text-shadow: 0 0 0 #000 !important;
}

.reveal pre code {
	overflow: hidden !important;
	font-family: Courier, 'Courier New', monospace !important;
}

ul, ol, div, p {
	visibility: visible;
	position: static;
	width: auto;
	height: auto;
	display: block;
	overflow: visible;
	margin: auto;
}
.reveal {
	width: auto !important;
	height: auto !important;
	overflow: hidden !important;
}
.reveal .slides {
	position: static;
	width: 100%;
	height: auto;

	left: auto;
	top: auto;
	margin: 0 !important;
	padding: 0 !important;

	overflow: visible;
	display: block;

	-webkit-perspective: none;
	   -moz-perspective: none;
	    -ms-perspective: none;
	        perspective: none;

	-webkit-perspective-origin: 50% 50%; /* there isn't a none/auto value but 50-50 is the default */
	   -moz-perspective-origin: 50% 50%;
	    -ms-perspective-origin: 50% 50%;
	        perspective-origin: 50% 50%;
}

.reveal .slides section {
	page-break-after: always !important;

	visibility: visible !important;
	position: relative !important;
	display: block !important;
	position: relative !important;

	margin: 0 !important;
	padding: 0 !important;
	box-sizing: border-box !important;
	min-height: 1px;

	opacity: 1 !important;

	-webkit-transform-style: flat !important;
	   -moz-transform-style: flat !important;
	    -ms-transform-style: flat !important;
	        transform-style: flat !important;

	-webkit-transform: none !important;
	   -moz-transform: none !important;
	    -ms-transform: none !important;
	        transform: none !important;
}

.reveal section.stack {
	margin: 0 !important;
	padding: 0 !important;
	page-break-after: avoid !important;
	height: auto !important;
	min-height: auto !important;
}

.reveal img {
	box-shadow: none;
}

.reveal .roll {
	overflow: visible;
	line-height: 1em;
}

/* Slide backgrounds are placed inside of their slide when exporting to PDF */
.reveal section .slide-background {
	display: block !important;
	position: absolute;
	top: 0;
	left: 0;
	width: 100%;
	z-index: -1;
}

/* All elements should be above the slide-background */
.reveal section>* {
	position: relative;
	z-index: 1;
}

/* Display slide speaker notes when 'showNotes' is enabled */
.reveal .speaker-notes-pdf {
	display: block;
	width: 100%;
	max-height: none;
	left: auto;
	top: auto;
	z-index: 100;
}

/* Display slide numbers when 'slideNumber' is enabled */
.reveal .slide-number-pdf {
	display: block;
	position: absolute;
	font-size: 14px;
}

</script>


<script>
var style = document.createElement( 'style' );
style.type = 'text/css';
var style_script_id = window.location.search.match( /print-pdf/gi ) ? 'pdf-css' : 'paper-css';
var style_script = document.getElementById(style_script_id).text;
style.innerHTML = style_script;
document.getElementsByTagName('head')[0].appendChild(style);
</script>

</head>
<body>
  <div class="reveal">
    <div class="slides">


<section id="section" class="slide level2">
<h2></h2>
<img data-src="Images/mlr/wonka_mult_regression.jpg" />
<h2>
Multiple Predictor Variables in General Linear Models
</h2>
</section>
<section id="section-1" class="slide level2">
<h2></h2>
 <br />
<br />

<h3>
<a href="https://etherpad.wikimedia.org/p/355-mlr" class="uri">https://etherpad.wikimedia.org/p/355-mlr</a>
</h3>
</section>
<section id="data-generating-processes-until-now" class="slide level2">
<h2>Data Generating Processes Until Now</h2>
<ul>
<li><p>One predictor with one response<br />
<br />
</p></li>
<li><p>Except…ANOVA had multiple possible treatment levels</p></li>
</ul>
</section>
<section id="the-general-linear-model" class="slide level2">
<h2>The General Linear Model</h2>
<p><span class="math display">\[\Large \boldsymbol{Y} = \boldsymbol{\beta X} + \boldsymbol{\epsilon} \]</span></p>
<ul>
<li><p>This equation is huge. X can be anything - categorical, continuous, squared, sine, etc.</p></li>
<li><p>There can be straight additivity, or interactions</p></li>
<li><p>So far, the only model we’ve used with &gt;1 predictor is ANOVA</p></li>
</ul>
</section>
<section id="models-with-many-predictors" class="slide level2">
<h2>Models with Many Predictors</h2>
<ol start="0" type="1">
<li><p>ANOVA</p></li>
<li><p>ANCOVA</p></li>
<li><p>Multiple Linear Regression</p></li>
<li><p>MLR with Interactions</p></li>
</ol>
</section>
<section id="analysis-of-covariance" class="slide level2">
<h2>Analysis of Covariance</h2>
<p><span class="math display">\[\Large \boldsymbol{Y} = \boldsymbol{\beta X} + \boldsymbol{\epsilon}\]</span><br />
<br />
<br />
<span class="math display">\[Y = \beta_0 + \beta_{1}x  + \sum_{i=2}^{k}\beta_i + \epsilon\]</span></p>
</section>
<section id="analysis-of-covariance-1" class="slide level2">
<h2>Analysis of Covariance</h2>
<p><span class="math display">\[Y = \beta_0 + \beta_{1}x  + \sum_{i=2}^{k}\beta_i + \epsilon\]</span></p>
<ul>
<li>ANOVA + a continuous predictor<br />
<br />
</li>
<li>Often used to correct for a gradient or some continuous variable affecting outcome<br />
<br />
</li>
<li>OR used to correct a regression due to additional groups that may throw off slope estimates<br />

<ul>
<li>e.g. Simpson’s Paradox: A positive relationship between test scores and academic performance can be masked by gender differences</li>
</ul></li>
</ul>
</section>
<section id="neanderthals-and-ancova" class="slide level2">
<h2>Neanderthals and ANCOVA</h2>
<p><img data-src="./Images/mlr/neanlooking.jpeg" alt="image" style="width:60.0%" /></p>
<p>Who had a bigger brain: Neanderthals or us?</p>
</section>
<section id="the-means-look-the-same" class="slide level2">
<h2>The Means Look the Same…</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/neand_boxplot-1.jpeg" width="768" /></p>
</section>
<section id="but-there-appears-to-be-a-relationship-between-body-and-brain-mass" class="slide level2">
<h2>But there appears to be a Relationship Between Body and Brain Mass</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/neand_plot-1.jpeg" width="768" /></p>
</section>
<section id="and-mean-body-mass-is-different" class="slide level2">
<h2>And Mean Body Mass is Different</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/neand_boxplot2-1.jpeg" width="768" /></p>
</section>
<section id="section-2" class="slide level2">
<h2></h2>
<p><br />
<br />
<img data-src="Images/mlr/redo_analysis.jpg" /></p>
</section>
<section id="analysis-of-covariance-2" class="slide level2">
<h2>Analysis of Covariance</h2>
<p>Evaluate a categorical effect(s), controlling for a <em>covariate</em> (parallel lines)<br />
</p>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/neand_plot_fit-1.jpeg" width="672" /></p>
<p>Groups modify the <em>intercept</em>.</p>
</section>
<section id="the-steps-of-statistical-modeling" class="slide level2">
<h2>The Steps of Statistical Modeling</h2>
<ol type="1">
<li>What is your question?</li>
<li>What model of the world matches your question?</li>
<li>Build a test</li>
<li>Evaluate test assumptions</li>
<li>Evaluate test results</li>
<li>Visualize</li>
</ol>
</section>
<section id="assumptions-of-multiway-ancova" class="slide level2">
<h2>Assumptions of Multiway ANCOVA</h2>
<ul>
<li><p>Independence of data points</p></li>
<li><p>Normality and homoscedacticity within groups (of residuals)</p></li>
<li><p>No relationship between fitted and residual values</p></li>
<li><p>Additivity of Treatment and Covariate (Parallel Slopes)</p></li>
</ul>
</section>
<section id="the-usual-suspects-of-assumptions" class="slide level2">
<h2>The Usual Suspects of Assumptions</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/zoop_assumptions-1.jpeg" width="768" /></p>
</section>
<section id="look-at-residuals-by-predictor" class="slide level2">
<h2>Look at Residuals by Predictor</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/zoop_group_assumptions-1.jpeg" width="768" /></p>
</section>
<section id="test-for-parallel-slopes" class="slide level2">
<h2>Test for Parallel Slopes</h2>
We test a model where <span class="math display">\[Y = \beta_0 + \beta_{1}x  + \sum_{i=2}^{k}\beta_i + \sum_{j=k+2}^{2k+2}\beta_{j}x + \epsilon\]</span>
<div class="fragment">
<table>
<thead>
<tr class="header">
<th></th>
<th style="text-align: right;">Sum Sq</th>
<th style="text-align: right;">Df</th>
<th style="text-align: right;">F value</th>
<th style="text-align: right;">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>species</td>
<td style="text-align: right;">0.0275528</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.220266</td>
<td style="text-align: right;">0.0175024</td>
</tr>
<tr class="even">
<td>lnmass</td>
<td style="text-align: right;">0.1300183</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">29.352684</td>
<td style="text-align: right;">0.0000045</td>
</tr>
<tr class="odd">
<td>species:lnmass</td>
<td style="text-align: right;">0.0048452</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.093849</td>
<td style="text-align: right;">0.3027897</td>
</tr>
<tr class="even">
<td>Residuals</td>
<td style="text-align: right;">0.1550332</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
</tbody>
</table>
</div>
<br />

<div class="fragment">
If you have an interaction, welp, that’s a different model - slopes vary by group!
</div>
</section>
<section id="ye-olde-f-test" class="slide level2">
<h2>Ye Olde F-Test</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">Anova</span>(neand_lm)</a></code></pre></div>
<pre><code>Anova Table (Type II tests)

Response: lnbrain
            Sum Sq Df F value    Pr(&gt;F)    
species   0.027553  1  6.2041   0.01749 *  
lnmass    0.130018  1 29.2764 4.262e-06 ***
Residuals 0.159878 36                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</section>
<section id="vsualizing-result" class="slide level2">
<h2>Vsualizing Result</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/neand_plot_fit-1.jpeg" width="768" /></p>
</section>
<section id="parcelling-out-covariate" class="slide level2">
<h2>Parcelling Out Covariate</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">crPlots</span>(neand_lm)</a></code></pre></div>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/cr_ancova-1.jpeg" width="768" /></p>
</section>
<section id="parcelling-out-covariate-with-posthocs-least-square-menas" class="slide level2">
<h2>Parcelling Out Covariate with PostHocs &amp; Least Square Menas</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">library</span>(emmeans)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">em &lt;-<span class="st"> </span><span class="kw">emmeans</span>(neand_lm, <span class="dt">specs=</span><span class="st">&quot;species&quot;</span>, </a>
<a class="sourceLine" id="cb4-3" data-line-number="3">        <span class="dt">by =</span> <span class="st">&quot;lnmass&quot;</span>)</a>
<a class="sourceLine" id="cb4-4" data-line-number="4"></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">em</a></code></pre></div>
<pre><code>lnmass = 4.197949:
 species       emmean         SE df lower.CL upper.CL
 neanderthal 7.271581 0.02418546 36 7.222530 7.320631
 recent      7.341859 0.01250077 36 7.316506 7.367212

Confidence level used: 0.95 </code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">contrast</span>(em, <span class="st">&quot;pairwise&quot;</span>)</a></code></pre></div>
<pre><code>lnmass = 4.197949:
 contrast               estimate         SE df t.ratio p.value
 neanderthal - recent -0.0702784 0.02821518 36  -2.491  0.0175</code></pre>
<p>Evluated at mean of covariate</p>
</section>
<section id="models-with-many-predictors-1" class="slide level2">
<h2>Models with Many Predictors</h2>
<ol start="0" type="1">
<li><p>ANOVA</p></li>
<li><p>ANCOVA</p></li>
<li><p><font color="red">Multiple Linear Regression</font></p></li>
<li><p>MLR with Interactions</p></li>
</ol>
</section>
<section id="one-way-anova-graphically" class="slide level2">
<h2>One-Way ANOVA Graphically</h2>
<p><img data-src="./Images/mlr/anova.png" alt="image" style="width:60.0%" /></p>
</section>
<section id="multiple-linear-regression" class="slide level2">
<h2>Multiple Linear Regression?</h2>
<p><img data-src="./Images/mlr/regression1.png" alt="image" style="width:60.0%" /></p>
<div style="text-align:left">
Note no connection between predictors, as in ANOVA. This is ONLY true ifwe have manipulated variables so that there is no relationship between the two. This is not often the case!
</div>
</section>
<section id="multiple-linear-regression-1" class="slide level2">
<h2>Multiple Linear Regression</h2>
<p><img data-src="./Images/mlr/regression2.png" alt="image" style="width:60.0%" /></p>
<div style="text-align:left">
<p>Curved double-headed arrow indicates COVARIANCE between predictors that we must account for.<br />
<br />
MLR controls for the correlation - estimates unique contribution of each predictor.</p>
</div>
</section>
<section id="section-3" class="slide level2" data-background="Images/mlr/fires.jpg">
<h2></h2>
<div style="bottom:100%; text-align:left; background:goldenrod">
<h4>
Five year study of wildfires &amp; recovery in Southern California shur- blands in 1993. 90 plots (20 x 50m)
</h4>
(data from Jon Keeley et al.)
</div>
</section>
<section id="what-causes-species-richness" class="slide level2">
<h2>What causes species richness?</h2>
<ul>
<li>Distance from fire patch</li>
<li>Elevation</li>
<li>Abiotic index</li>
<li>Patch age</li>
<li>Patch heterogeneity</li>
<li>Severity of last fire</li>
<li>Plant cover</li>
</ul>
</section>
<section id="many-things-may-influence-species-richness" class="slide level2">
<h2>Many Things may Influence Species Richness</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/keeley_pairs-1.jpeg" width="768" /></p>
</section>
<section id="our-model" class="slide level2">
<h2>Our Model</h2>
<br />
<br />
<span class="math display">\[Richness_i =\beta_{0} + \beta_{1} cover +\beta_{2} firesev + \beta_{3}hetero +\epsilon_i\]</span><br />
<br />

<div class="fragment">
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">klm &lt;-<span class="st"> </span><span class="kw">lm</span>(rich <span class="op">~</span><span class="st"> </span>cover <span class="op">+</span><span class="st"> </span>firesev <span class="op">+</span><span class="st"> </span>hetero, <span class="dt">data=</span>keeley)</a></code></pre></div>
</div>
</section>
<section id="testing-assumptions" class="slide level2">
<h2>Testing Assumptions</h2>
<ul>
<li class="fragment">Data Generating Process: Linearity<br />
<br />
</li>
<li class="fragment">Error Generating Process: Normality &amp; homoscedasticity of residuals<br />
<br />
</li>
<li class="fragment">Data: Outliers not influencing residuals<br />
<br />
</li>
<li class="fragment">Predictors: Minimal multicollinearity</li>
</ul>
</section>
<section id="section-4" class="slide level2">
<h2></h2>
<p><img data-src="./Images/mlr/gosling_multicollinearity.jpg" /></p>
</section>
<section id="checking-for-multicollinearity-correlation-matrices" class="slide level2">
<h2>Checking for Multicollinearity: Correlation Matrices</h2>
<pre><code>             cover     firesev      hetero
cover    1.0000000 -0.43713460 -0.16837784
firesev -0.4371346  1.00000000 -0.05235518
hetero  -0.1683778 -0.05235518  1.00000000</code></pre>
<div style="text-align:left">
Correlations over 0.4 can be problematic, but, they may be OK even as high as 0.8.<br />
<br />
Beyond this, are you getting unique information from each variable?
</div>
</section>
<section id="checking-for-multicollinearity-variance-inflation-factor" class="slide level2">
<h2>Checking for Multicollinearity: Variance Inflation Factor</h2>
<ul>
<li class="fragment">Consider <span class="math inline">\(y_i = \beta_{0} + \beta_{1}x_{1i} + \beta_{2}x_{2i} + \epsilon_i\)</span><br />
<br />
</li>
<li class="fragment">Now what about <span class="math inline">\(x_{1j} = \alpha_{0} + \alpha_{2}x_{2j} + \epsilon_j\)</span><br />
<br />
<br />
<span class="fragment"><span class="math display">\[VIF = \frac{1}{1-R^2_{1}}\]</span> </span></li>
</ul>
</section>
<section id="checking-for-multicollinearity-variance-inflation-factor-1" class="slide level2">
<h2>Checking for Multicollinearity: Variance Inflation Factor</h2>
<p><span class="math display">\[VIF_1 = \frac{1}{1-R^2_{1}}\]</span></p>
<pre><code>   cover  firesev   hetero 
1.294950 1.261695 1.050381 </code></pre>
<div style="text-align:left">
<p>VIF <span class="math inline">\(&gt;\)</span> 5 or 10 can be problematic and indicate an unstable solution.<br />
<br />
Solution: evaluate correlation and drop a predictor</p>
</div>
</section>
<section id="other-diagnostics-as-usual" class="slide level2">
<h2>Other Diagnostics as Usual!</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/klm_diag-1.jpeg" width="768" /></p>
</section>
<section id="examine-residuals-with-respect-to-each-predictor" class="slide level2">
<h2>Examine Residuals With Respect to Each Predictor</h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">residualPlots</span>(klm, <span class="dt">test=</span><span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/klm_diag2-1.jpeg" width="768" /></p>
</section>
<section id="which-variables-explained-variation" class="slide level2">
<h2>Which Variables Explained Variation</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw">Anova</span>(klm)</a></code></pre></div>
<pre><code>Anova Table (Type II tests)

Response: rich
           Sum Sq Df F value    Pr(&gt;F)    
cover      1674.2  1 12.0137 0.0008264 ***
firesev     635.6  1  4.5613 0.0355441 *  
hetero     4864.5  1 34.9073 6.757e-08 ***
Residuals 11984.6 86                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</section>
<section id="the-coefficients" class="slide level2">
<h2>The coefficients</h2>
<pre><code>
Call:
lm(formula = rich ~ cover + firesev + hetero, data = keeley)

Residuals:
     Min       1Q   Median       3Q      Max 
-23.6796  -8.6559  -0.1412   9.8656  22.3339 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.6793    10.6737   0.157 0.875352    
cover        15.5579     4.4886   3.466 0.000826 ***
firesev      -1.8167     0.8506  -2.136 0.035544 *  
hetero       65.9915    11.1694   5.908 6.76e-08 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 11.8 on 86 degrees of freedom
Multiple R-squared:  0.4099,    Adjusted R-squared:  0.3893 
F-statistic: 19.91 on 3 and 86 DF,  p-value: 6.874e-10</code></pre>
<p>R<sup>2</sup> = 0.4098626</p>
</section>
<section id="visualization-of-4-d-multivariate-models-is-difficult" class="slide level2">
<h2>Visualization of 4-D Multivariate Models is Difficult!</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/klm_see_effects-1.jpeg" width="768" /></p>
</section>
<section id="component-residual-plots-aid-in-visualization" class="slide level2">
<h2>Component-Residual Plots Aid in Visualization</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/klm_crplot-1.jpeg" width="768" /></p>
<p>Takes effect of predictor + residual of response</p>
</section>
<section id="or-show-regression-at-median-of-other-variables" class="slide level2">
<h2>Or Show Regression at Median of Other Variables</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/klm_visreg-1.jpeg" width="768" /></p>
</section>
<section id="or-show-predictions-overlaid-on-data" class="slide level2">
<h2>Or Show Predictions Overlaid on Data</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/crazy-1.jpeg" width="768" /></p>
</section>
<section id="models-with-many-predictors-2" class="slide level2">
<h2>Models with Many Predictors</h2>
<ol start="0" type="1">
<li><p>ANOVA</p></li>
<li><p>ANCOVA</p></li>
<li><p>Multiple Linear Regression</p></li>
<li><p><font color="red">MLR with Interactions</font></p></li>
</ol>
</section>
<section id="problem-what-if-continuous-predictors-are-not-additive" class="slide level2">
<h2>Problem: What if Continuous Predictors are Not Additive?</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/keeley_int_plot3d-1.jpeg" width="672" /></p>
</section>
<section id="problem-what-if-continuous-predictors-are-not-additive-1" class="slide level2">
<h2>Problem: What if Continuous Predictors are Not Additive?</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/keeley_int_plot-1.jpeg" width="768" /></p>
</section>
<section id="problem-what-if-continuous-predictors-are-not-additive-2" class="slide level2">
<h2>Problem: What if Continuous Predictors are Not Additive?</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/keeley_int_plot2-1.jpeg" width="768" /></p>
</section>
<section id="section-5" class="slide level2">
<h2></h2>
<p><br />
<br />
<img data-src="./Images/mlr/regression_depression.jpg" /></p>
</section>
<section id="model-for-age-interacting-with-elevation-to-influence-fire-severity" class="slide level2">
<h2>Model For Age Interacting with Elevation to Influence Fire Severity</h2>
<p><span class="math display">\[y = \beta_0 + \beta_{1}x_{1} + \beta_{2}x_{2}+ \beta_{3}x_{1}x_{2}\]</span><br />
<br />
</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">keeley_lm_int &lt;-<span class="st"> </span><span class="kw">lm</span>(firesev <span class="op">~</span><span class="st"> </span>age<span class="op">*</span>elev, <span class="dt">data=</span>keeley)</a></code></pre></div>
</section>
<section id="testing-assumptions-1" class="slide level2">
<h2>Testing Assumptions</h2>
<ul>
<li class="fragment">Data Generating Process: Linearity<br />
<br />
</li>
<li class="fragment">Error Generating Process: Normality &amp; homoscedasticity of residuals<br />
<br />
</li>
<li class="fragment">Data: Outliers not influencing residuals<br />
<br />
</li>
<li class="fragment">Predictors: Minimal collinearity</li>
</ul>
</section>
<section id="other-diagnostics-as-usual-1" class="slide level2">
<h2>Other Diagnostics as Usual!</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/klm_diag_int-1.jpeg" width="768" /></p>
</section>
<section id="examine-residuals-with-respect-to-each-predictor-1" class="slide level2">
<h2>Examine Residuals With Respect to Each Predictor</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/klm_diag2_int-1.jpeg" width="768" /></p>
</section>
<section id="interactions-vif-and-centering" class="slide level2">
<h2>Interactions, VIF, and Centering</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="kw">vif</span>(keeley_lm_int)</a></code></pre></div>
<pre><code>     age     elev age:elev 
3.200054 5.517494 8.287104 </code></pre>
<br />

<div class="fragment" style="text-align:left">
<p>This isn’t that bad. But it can be.<br />
<br />
</p>
</div>
<div class="fragment" style="text-align:left">
<p>Often, interactions or nonlinear derived predictors are collinear with one or more of their predictors.<br />
<br />
</p>
</div>
<div class="fragment" style="text-align:left">
<p>To remove, this, we <strong>center</strong> predictors - i.e., <span class="math inline">\(X_i - mean(X)\)</span></p>
</div>
</section>
<section id="interpretation-of-centered-coefficients" class="slide level2">
<h2>Interpretation of Centered Coefficients</h2>
<p><span class="math display">\[\huge X_i - \bar{X}\]</span></p>
<ul>
<li class="fragment">Additive coefficients are the effect of a predictor at the mean value of the other predictors<br />
<br />
</li>
<li class="fragment">Intercepts are at the mean value of all predictors<br />
<br />
</li>
<li class="fragment">Visualization will keep you from getting confused!<br />
</li>
</ul>
</section>
<section id="interactions-vif-and-centering-1" class="slide level2">
<h2>Interactions, VIF, and Centering</h2>
<p><span class="math display">\[y = \beta_0 + \beta_{1}(x_{1}-\bar{x_{1}}) + \beta_{2}(x_{2}-\bar{x_{2}})+ \beta_{3}(x_{1}-\bar{x_{1}})(x_{2}-\bar{x_{2}})\]</span></p>
<br />
<br />

<p align="left">
Variance Inflation Factors for Centered Model:
</p>
<pre><code>       age_c       elev_c age_c:elev_c 
    1.016721     1.041830     1.037929 </code></pre>
</section>
<section id="f-tests-to-evaluate-model" class="slide level2">
<h2>F-Tests to Evaluate Model</h2>
<pre><code>Anova Table (Type II tests)

Response: firesev
           Sum Sq Df F value    Pr(&gt;F)    
age        52.963  1 27.7092 1.023e-06 ***
elev        6.253  1  3.2715 0.0739877 .  
age:elev   22.305  1 11.6693 0.0009722 ***
Residuals 164.380 86                      
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
</section>
<section id="coefficients" class="slide level2">
<h2>Coefficients!</h2>
<table>
<thead>
<tr class="header">
<th></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td style="text-align: right;">1.8132153</td>
<td style="text-align: right;">0.6156070</td>
<td style="text-align: right;">2.945411</td>
<td style="text-align: right;">0.0041484</td>
</tr>
<tr class="even">
<td>age</td>
<td style="text-align: right;">0.1206292</td>
<td style="text-align: right;">0.0208618</td>
<td style="text-align: right;">5.782298</td>
<td style="text-align: right;">0.0000001</td>
</tr>
<tr class="odd">
<td>elev</td>
<td style="text-align: right;">0.0030852</td>
<td style="text-align: right;">0.0013329</td>
<td style="text-align: right;">2.314588</td>
<td style="text-align: right;">0.0230186</td>
</tr>
<tr class="even">
<td>age:elev</td>
<td style="text-align: right;">-0.0001472</td>
<td style="text-align: right;">0.0000431</td>
<td style="text-align: right;">-3.416029</td>
<td style="text-align: right;">0.0009722</td>
</tr>
</tbody>
</table>
<p><br />
<br />
R<sup>2</sup> = 0.3235187<br />
<br />
Note that additive coefficients signify the effect of one predictor in the abscence of all others.</p>
</section>
<section id="centered-coefficients" class="slide level2">
<h2>Centered Coefficients!</h2>
<table>
<thead>
<tr class="header">
<th></th>
<th style="text-align: right;">Estimate</th>
<th style="text-align: right;">Std. Error</th>
<th style="text-align: right;">t value</th>
<th style="text-align: right;">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td style="text-align: right;">4.6091266</td>
<td style="text-align: right;">0.1463029</td>
<td style="text-align: right;">31.503991</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td>age_c</td>
<td style="text-align: right;">0.0581123</td>
<td style="text-align: right;">0.0117591</td>
<td style="text-align: right;">4.941901</td>
<td style="text-align: right;">0.0000038</td>
</tr>
<tr class="odd">
<td>elev_c</td>
<td style="text-align: right;">-0.0006786</td>
<td style="text-align: right;">0.0005792</td>
<td style="text-align: right;">-1.171587</td>
<td style="text-align: right;">0.2445985</td>
</tr>
<tr class="even">
<td>age_c:elev_c</td>
<td style="text-align: right;">-0.0001472</td>
<td style="text-align: right;">0.0000431</td>
<td style="text-align: right;">-3.416029</td>
<td style="text-align: right;">0.0009722</td>
</tr>
</tbody>
</table>
<p><br />
<br />
R<sup>2</sup> = 0.3235187<br />
<br />
Note that additive coefficients signify the effect of one predictor at the average level of all others.</p>
</section>
<section id="interpretation" class="slide level2">
<h2>Interpretation</h2>
<ul>
<li class="fragment">What the heck does an interaction effect mean?<br />
<br />
</li>
<li class="fragment">We can look at the effect of one variable at different levels of the other<br />
<br />
</li>
<li class="fragment">We can look at a surface<br />
<br />
</li>
<li class="fragment">We can construct <em>counterfactual</em> plots showing how changing both variables influences our outcome</li>
</ul>
</section>
<section id="age-at-different-levels-of-elevation" class="slide level2">
<h2>Age at Different Levels of Elevation</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/int_visreg-1.jpeg" width="768" /></p>
</section>
<section id="elevation-at-different-levels-of-age" class="slide level2">
<h2>Elevation at Different Levels of Age</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/int_visreg_2-1.jpeg" width="768" /></p>
</section>
<section id="surfaces-and-other-3d-objects" class="slide level2">
<h2>Surfaces and Other 3d Objects</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/surf_int-1.jpeg" width="960" /></p>
</section>
<section id="or-all-in-one-plot" class="slide level2">
<h2>Or all in one plot</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/keeley_int_pred-1.jpeg" width="768" /></p>
</section>
<section id="without-data-and-including-cis" class="slide level2">
<h2>Without Data and Including CIs</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/keeley_int_pred_nodata-1.jpeg" width="768" /></p>
</section>
<section id="a-heatmap-approach" class="slide level2">
<h2>A Heatmap Approach</h2>
<p><img src="26_ancova_mulltreg_files/figure-revealjs/int_heatmap-1.jpeg" width="768" /></p>
</section>
<section id="section-6" class="slide level2">
<h2></h2>
<p><br />
<br />
<img data-src="Images/mlr/matrix_regression.jpg" /><br />
<span class="fragment">We can do a <em>lot</em> with the general linear model!<br></span> <span class="fragment">You are only limited by the biological models you can imagine.</span></p>
</section>
    </div>
  </div>

  <script src="libs/reveal.js-3.3.0.1/lib/js/head.min.js"></script>
  <script src="libs/reveal.js-3.3.0.1/js/reveal.js"></script>

  <script>

      // Full list of configuration options available at:
      // https://github.com/hakimel/reveal.js#configuration
      Reveal.initialize({
        // Display the page number of the current slide
        slideNumber: true,
        // Push each slide change to the browser history
        history: true,
        // Vertical centering of slides
        center: false,
        // Opens links in an iframe preview overlay
        previewLinks: true,
        // Transition style
        transition: 'fade', // none/fade/slide/convex/concave/zoom
        // Transition style for full page slide backgrounds
        backgroundTransition: 'default', // none/fade/slide/convex/concave/zoom



        // Optional reveal.js plugins
        dependencies: [
        ]
      });
    </script>
  <!-- dynamically load mathjax for compatibility with self-contained -->
  <script>
    (function () {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
      document.getElementsByTagName("head")[0].appendChild(script);
    })();
  </script>

<script>
  (function() {
    if (window.jQuery) {
      Reveal.addEventListener( 'slidechanged', function(event) {  
        window.jQuery(event.previousSlide).trigger('hidden');
        window.jQuery(event.currentSlide).trigger('shown');
      });
    }
  })();
</script>


  </body>
</html>
